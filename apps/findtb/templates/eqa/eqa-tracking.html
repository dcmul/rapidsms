{% extends "findtb-tracking.html" %}

{% load findtb_format  %}

{% block javascripts %}

     <script type="text/javascript" 
             src="/static/findtb/js/eqa.js">
    </script>
    
    {{ form.media }}
        
{% endblock %}

{% block page-id %}eqa-tracking{% endblock %}

{% block title %}EQA Tracking{% endblock %}

{% block findtb-title %}
    EQA tracking: {{ slides_batch.location.name }}
{% endblock %}


{% block tracking-form %}


{% endblock %}

    
{% block findtb-events-title %}Follow up{% endblock %}

{% block findtb-events-selection %}

    <!-- TODO : add a cancel link in the last event so they can always undo 
    something. A good place to put it would be next to the date. 
    Cancel must be confirmed -->
    
    {% if events.count %}
        <ul id="findtb-event-picker-selection">
            {% for state in events %}
            <li class="{{ state.type }}">
                    <strong>{{ state.content_object.get_short_message }}</strong>
                    <span>{{ state.created|humanize_time_delta|default_if_none:"1 second ago" }}</span> 
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Nothing has happened yet</p>   
    {% endif %}

{% endblock %}
        
{% block findtb-contacts %}

    {% if contacts %}
    
       <dl id="findtb-contacts">
       
       {% for role, reporters in contacts.iteritems %}
       
            <dt>{{ role.title }}:</dt>
            
            {% for reporter in reporters %}
                <dd>
                    <em>
                    {{ reporter.last_name|upper }}
                    {{ reporter.first_name }} 
                    </em>:
                    +{{reporter.connection.identity}}
                </dd>
            {% endfor %}
            
       {% endfor %}
       
       </dl>
       
    {% else %}
       <p id="findtb-contacts">No phone contact for this slides batch </p>
    {% endif %}
            
{% endblock %}
   
   
{% block findtb-test-picker-title %}Select DTU{% endblock %}

{% block findtb-test-picker-selection %}

   <form id="zone-selector" method="post" action='.'>
   <p><label for="zone">Zones</label>
   <select name="zone" id="zone">
       <option value="all">All</option>
       {% for zone in zones %}
       <option
               {% ifequal zone.pk selected_zone %}
               selected="selected"
               {% endifequal %}
               value="{{ zone.pk }}">
        {{ zone.name }}
       </option>
       {% endfor %}
   </select>
   <input type="submit" value="OK"/></p>
   </form>
   
   <form id="district-selector" method="post" action='.'>
   <p><label for="district">Districts</label>
   <select name="district" id="district">
       <option value="all">All</option>
       {% for district in districts %}
       <option 
               {% ifequal district.id selected_district %}
               selected="selected"
               {% endifequal %}
               value="{{ district.id }}">
        {{ district.name }}
       </option>
       {% endfor %}}
   </select>
   <input type="submit"  value="OK"/></p>
   </form>

   {% if dtus %}
       <ul id="findtb-dtu-selector">
       {% for dtu in dtus %}
           <li>
                <a href="{% url findtb-eqa-tracking dtu.pk %}">
                    {{ dtu.name }}
                </a>
           </li>
       {% endfor %}
       </ul>
   {% else %}    
        <p>No slides to test yet</p>
   {% endif%}
   
{% endblock %}
